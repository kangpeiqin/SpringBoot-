<p> <a href="../README.md">返回首页</a></p>

# 分布式
对于一个应用系统包含两部分需求：功能性需求(该应用是来做什么的)、非功能性需求(应用系统的扩展性、
灵活性、性能、监控等需求，用来保障业务系统能够正确、顺畅地运行)。
> 微服务架构将一个应用拆分成多个松耦合的服务，这些服务通过某种协议进行相互合作，完成单体架构下
的业务功能，但提供了更灵活的部署模式，更容易扩展，降低了开发、运维的复杂度。
## CAP 理论
## 微服务架构
### 服务治理
让作为消费者的微服务知道服务提供者并能够进行消费。
- `Nacos`
> `Nacos`是一款集服务注册发现、服务配置和管理于一身的开源软件。
### 网关
介于客户端与服务端之间的中间层，客户端只需要跟服务网关交互，无需调用具体的微服务接口。
这样的好处在于，客户端可以降低复杂性；对于需要认证的服务，只需要在服务网关配置即可；
同样也方便后期微服务的变更和重构，即微服务接口变更只需在服务网关调整配置即可，无需更改客户端代码。
## Zookeeper
分布式应用程序协调服务，提供了一些在分布式环境下的通知或者存储的手段。是一个为分布式应用提供一致性服务的软件，为大型分布式计算提供开源的分布式配置服务、同步服务和命名注册。
### Java `ZK` 客户端库
zookeeper，GitHub 地址：https://github.com/apache/zookeeper
curator，GitHub 地址：https://github.com/apache/curator
## `Dubbo`
`Dubbo`是一款由阿里巴巴开发的远程服务调用框架（RPC），其可以透明化的调用远程服务，就像调用本地服务一样。
Zookeeper在这里充当的是服务注册中心的角色，我们将各个微服务提供的服务通过`Dubbo`注册到Zookeeper中，然后服务消费者通过`Dubbo`从Zookeeper中获取相应服务并消费。
### 基本操作
ZK 定义了每一个记录必须有一个对应路径，类似于 Linux 标准文件系统。
- 分布式锁的实现

参考文档：
- <a href = 'https://github.com/HelloGitHub-Team/HelloZooKeeper' target='view_window'>HelloZookeeper</a>
- https://www.jianshu.com/p/1f4c70d7ef40

## 搜索
### Elasticsearch
`ES`是建立在`Lucene`基础之上的分布式准实时搜索引擎，提供了`REST`风格的`API`接口，使用`HTTP`对
`ES`执行请求来完成搜索任务。`ES`本身还提供了聚合功能，用户可以使用该功能对索引中的数据进行统计分析；
在数据安全方面，`ES`提供了`X-Pack`进行用户验证。ES属于非关系型数据库。每台服务器可以运行多个 Elastic 实例。
单个 Elastic 实例称为一个节点（node）。一组节点构成一个集群（cluster）。
- `ELK`
> E代表`Elasticsearch`，主要提供数据搜索和分析功能；L代表`Logstash`，借助它可以将数据库和日志等结构化或非结构化数据轻松地导入ES中；K代表`Kibana`，
它可以将分析结果进行图形化展示
#### 基本概念
##### 索引(index)
在使用传统的关系型数据库时，如果对数据有存取和更新操作，需要建立一个数据库。相应地，在ES中则需要建立索引。
##### 文档(document)
在使用传统的关系型数据库时，需要把数据封装成数据库中的一条记录，而在ES中对应的则是文档。
用户对数据操作的最细粒度对象就是文档。ES文档操作使用了版本的概念，即文档的初始版本为1，
每次的写操作会把文档的版本加1，每次使用文档时，ES返回给用户的是最新版本的文档。
> Index 里面单条的记录称为 Document（文档）。许多条 Document 构成了一个 Index。
##### 字段
一个文档可以包含一个或多个字段，每个字段都有一个类型与其对应。除了常用的数据类型（如字符串型、文本型和数值型）外，ES还提供了多种数据类型，
如数组类型、经纬度类型和IP地址类型等。
##### 映射
建立索引时需要定义文档的数据结构，这种结构叫作映射。
##### 分片
在分布式系统中，为了能存储和计算海量的数据，会先对数据进行切分，然后再将它们存储到多台计算机中。
#### 应用场景
- 如电商搜索、地图搜索、新闻搜索等各类站内搜索
> 创建索引时，业务系统模块把数据存储到数据库中，第三方数据同步模块（如Canal）负责将数据库中的数据按照业务需求同步到ES中。
搜索时，前端应用先向搜索模块发起搜索请求，然后搜索模块组织搜索DSL向ES发起请求，ES响应搜索模块的请求开始搜索，
并将搜索到的商品信息（如名称、价格、地理位置等）进行封装，
然后把数据传送给搜索模块，进而数据再由搜索模块传递到前端进行展现。
#### 参考
- [全文搜索引擎 Elasticsearch 入门教程](https://ruanyifeng.com/blog/2017/08/elasticsearch.html)

## 分布式锁
多个进程，需要同时操作一个共享资源，保持互斥。例如，现在的业务应用通常都是微服务架构，这也意味着一个应用会部署多个进程，那这多个进程如果需要修改 MySQL 中的同一行记录时，为了避免操作乱序导致数据错误。
### 单机锁
避免同时操作一个共享变量产生数据问题，通常会使用一把锁来「互斥」，以保证共享变量的正确性，其使用范围是在「同一个进程」中。
### 应用场景
